<svg
  class="fp-diagram"
  viewBox="0 0 960 420"
  role="img"
  aria-labelledby="fp-time-title fp-time-desc"
  xmlns="http://www.w3.org/2000/svg"
>
  <title id="fp-time-title">Time indices in Tau streams</title>
  <desc id="fp-time-desc">
    A two-row timeline for an input stream i1 and an output stream o1. Boxes show values at t-2, t-1, t, and t+1.
    Arrows indicate that o1[t] depends on the previous output o1[t-1] and the current input i1[t]. A stencil overlays
    the relevant boxes, illustrating that the same local relationship is applied at every time step.
  </desc>

  <defs>
    <filter id="fp-time-shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="12" flood-color="#0F172A" flood-opacity="0.10" />
    </filter>
    <marker
      id="fp-time-arrow"
      markerWidth="12"
      markerHeight="12"
      refX="10"
      refY="6"
      orient="auto"
    >
      <path d="M0,0 L12,6 L0,12 Z" fill="#3B82F6" fill-opacity="0.9" />
    </marker>
  </defs>

  <g filter="url(#fp-time-shadow)">
    <rect x="40" y="60" width="880" height="300" rx="26" fill="#FFFFFF" stroke="#E2E8F0" />

    <text
      x="90"
      y="120"
      font-size="16"
      font-weight="900"
      fill="#1E293B"
      font-family="Atkinson Hyperlegible, system-ui, sans-serif"
    >
      Time indices in streams
    </text>
    <text
      x="90"
      y="145"
      font-size="12"
      fill="#475569"
      font-family="Atkinson Hyperlegible, system-ui, sans-serif"
    >
      Think “tape of values”: t is a position, t-1 is one step earlier.
    </text>

    <!-- Column headers -->
    <g font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace" font-size="12" fill="#475569">
      <text x="245" y="182" text-anchor="middle">t-2</text>
      <text x="415" y="182" text-anchor="middle">t-1</text>
      <text x="585" y="182" text-anchor="middle">t</text>
      <text x="755" y="182" text-anchor="middle">t+1</text>
    </g>

    <!-- Row labels -->
    <g font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace" font-size="14" fill="#1E293B">
      <text x="120" y="228">i1</text>
      <text x="120" y="298">o1</text>
    </g>

    <!-- Grid cells -->
    <g>
      <!-- Base cells -->
      <g fill="rgba(15, 23, 42, 0.03)" stroke="rgba(15, 23, 42, 0.10)">
        <!-- row i1 -->
        <rect x="170" y="195" width="150" height="54" rx="14" />
        <rect x="340" y="195" width="150" height="54" rx="14" />
        <rect x="510" y="195" width="150" height="54" rx="14" />
        <rect x="680" y="195" width="150" height="54" rx="14" />
        <!-- row o1 -->
        <rect x="170" y="265" width="150" height="54" rx="14" />
        <rect x="340" y="265" width="150" height="54" rx="14" />
        <rect x="510" y="265" width="150" height="54" rx="14" />
        <rect x="680" y="265" width="150" height="54" rx="14" />
      </g>

      <!-- Highlights: previous output, current input, current output -->
      <rect x="340" y="265" width="150" height="54" rx="14" fill="rgba(59, 130, 246, 0.10)" stroke="rgba(59, 130, 246, 0.24)" stroke-width="2" />
      <rect x="510" y="195" width="150" height="54" rx="14" fill="rgba(59, 130, 246, 0.10)" stroke="rgba(59, 130, 246, 0.24)" stroke-width="2" />
      <rect x="510" y="265" width="150" height="54" rx="14" fill="rgba(249, 115, 22, 0.10)" stroke="rgba(249, 115, 22, 0.24)" stroke-width="2" />

      <!-- Cell labels -->
      <g font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace" font-size="12" fill="#0F172A">
        <text x="415" y="297" text-anchor="middle">o1[t-1]</text>
        <text x="585" y="227" text-anchor="middle">i1[t]</text>
        <text x="585" y="297" text-anchor="middle">o1[t]</text>
      </g>

      <!-- Stencil overlay -->
      <rect x="322" y="178" width="356" height="158" rx="20" fill="rgba(148, 163, 184, 0.10)" stroke="rgba(148, 163, 184, 0.40)" stroke-dasharray="6 6" />
      <text
        x="500"
        y="188"
        text-anchor="middle"
        font-size="11"
        fill="#475569"
        font-family="Atkinson Hyperlegible, system-ui, sans-serif"
      >
        same local rule, applied for every t
      </text>

      <!-- Arrows into o1[t] -->
      <path d="M490 292 C520 292, 525 292, 510 292" stroke="#3B82F6" stroke-width="2.5" fill="none" marker-end="url(#fp-time-arrow)" />
      <path d="M585 249 C585 258, 585 258, 585 265" stroke="#3B82F6" stroke-width="2.5" fill="none" marker-end="url(#fp-time-arrow)" />

      <!-- plus sign -->
      <circle cx="535" cy="292" r="14" fill="#FFFFFF" stroke="rgba(15, 23, 42, 0.14)" />
      <text x="535" y="297" text-anchor="middle" font-size="16" font-weight="900" fill="#1E293B" font-family="Atkinson Hyperlegible, system-ui, sans-serif">+</text>
    </g>

    <!-- Bottom formula -->
    <g>
      <rect x="90" y="330" width="780" height="26" rx="13" fill="rgba(15, 23, 42, 0.03)" stroke="rgba(15, 23, 42, 0.10)" />
      <text
        x="480"
        y="348"
        text-anchor="middle"
        font-size="12"
        fill="#1E293B"
        font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace"
      >
        o1[t] = o1[t-1] + i1[t]
      </text>
    </g>
  </g>
</svg>
